/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AutoFitTabsPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/types.ts
var DEFAULT_SETTINGS = {
  minWidth: 40,
  closeButtonWidth: 28,
  leftPadding: 12,
  iconRightMargin: 0,
  closeButtonPadding: 0,
  transitionDuration: 275,
  iconWidth: 20,
  maxWidth: 0
  // 0 means disabled
};

// src/settings.ts
var import_obsidian = require("obsidian");
var AutoFitTabsSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    this.createSettingsUI(containerEl);
  }
  createSettingsUI(container) {
    [
      {
        name: "Close button padding",
        desc: "Space in pixels before close button",
        prop: "closeButtonPadding"
      },
      {
        name: "Transition duration",
        desc: "Duration in milliseconds for smooth transitions",
        prop: "transitionDuration"
      }
    ].forEach(({ name, desc, prop }) => {
      new import_obsidian.Setting(container).setName(name).setDesc(`${desc} (default: ${DEFAULT_SETTINGS[prop]})`).addText((text) => text.setPlaceholder(String(DEFAULT_SETTINGS[prop])).setValue(String(this.plugin.settings[prop])).onChange(async (value) => {
        const numValue = Number(value);
        if (!isNaN(numValue) && numValue >= 0) {
          this.plugin.settings[prop] = numValue;
          this.plugin.updateCSSVariables();
          await this.plugin.saveSettings();
        }
      }));
    });
    this.createSettingsSection(container, "Basic dimensions", [
      {
        name: "Minimum width",
        desc: "Minimum width in pixels for very short titles",
        prop: "minWidth"
      },
      {
        name: "Max width",
        desc: "Maximum width in pixels for tabs (0 to disable)",
        prop: "maxWidth"
      },
      {
        name: "Close button width",
        desc: "Width in pixels for the tab close button",
        prop: "closeButtonWidth"
      },
      {
        name: "Left padding",
        desc: "Padding in pixels before the icon",
        prop: "leftPadding"
      }
    ]);
    this.createSettingsSection(container, "Icons", [
      {
        name: "Icon width",
        desc: "Width in pixels for tab icons",
        prop: "iconWidth"
      },
      {
        name: "Icon right margin",
        desc: "Space in pixels between icon and text",
        prop: "iconRightMargin"
      }
    ]);
  }
  createSettingsSection(container, title, settings) {
    new import_obsidian.Setting(container).setName(title).setHeading();
    settings.forEach(({ name, desc, prop }) => {
      new import_obsidian.Setting(container).setName(name).setDesc(`${desc} (default: ${DEFAULT_SETTINGS[prop]})`).addText((text) => text.setPlaceholder(String(DEFAULT_SETTINGS[prop])).setValue(String(this.plugin.settings[prop])).onChange(async (value) => {
        const numValue = Number(value);
        if (!isNaN(numValue) && numValue >= 0) {
          this.plugin.settings[prop] = numValue;
          await this.plugin.saveSettings();
        }
      }));
    });
  }
};

// src/tabManager.ts
var TabManager = class {
  constructor(plugin) {
    this.tabWidthCache = /* @__PURE__ */ new Map();
    this.observer = null;
    this.iconObserver = null;
    this.measureElement = null;
    this.debounceTimeout = null;
    this.isAdjustmentQueued = false;
    this.isResetting = false;
    this.plugin = plugin;
  }
  initialize() {
    this.setupMeasureElement();
    this.registerEventHandlers();
    setTimeout(() => {
      this.queueHeaderAdjustment();
      this.setupMutationObserver();
      this.setupIconStabilizationObserver();
    }, 300);
  }
  cleanup() {
    this.tabWidthCache.clear();
    if (this.observer)
      this.observer.disconnect();
    if (this.iconObserver)
      this.iconObserver.disconnect();
    if (this.measureElement)
      this.measureElement.remove();
    const tabContainers = document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner");
    tabContainers.forEach((container) => {
      if (container instanceof HTMLElement) {
        container.style.overflowX = "";
        container.style.overflowY = "";
        container.scrollLeft = 0;
      }
    });
    const headers = this.getAllHeaders();
    headers.forEach((header) => {
      header.classList.add("autofit-cleanup");
      header.classList.remove("autofit-tab");
      header.classList.remove("autofit-max-width");
      header.style.removeProperty("--header-width");
      setTimeout(() => {
        header.classList.remove("autofit-cleanup");
      }, this.plugin.settings.transitionDuration);
    });
  }
  setupMeasureElement() {
    this.measureElement = document.createElement("span");
    this.measureElement.className = "autofit-tab-measure";
    document.body.appendChild(this.measureElement);
  }
  setupMutationObserver() {
    const tabContainers = document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container");
    if (!tabContainers || tabContainers.length === 0) {
      return;
    }
    this.observer = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        if (mutation.target && mutation.target instanceof Element) {
          if (!mutation.target.closest(".workspace-split.mod-vertical.mod-root")) {
            continue;
          }
          const isTabElement = mutation.target.closest(".workspace-split.mod-vertical.mod-root .workspace-tab-header") || mutation.target.classList.contains("workspace-tab-header-inner-title") && mutation.target.closest(".workspace-split.mod-vertical.mod-root");
          if (isTabElement) {
            this.queueHeaderAdjustment();
            return;
          }
          if (mutation.target === document.body && mutation.type === "attributes" && mutation.attributeName === "class") {
            this.tabWidthCache.clear();
            this.queueHeaderAdjustment();
            return;
          }
        }
      }
    });
    document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container").forEach((container) => {
      if (this.observer) {
        this.observer.observe(container, {
          childList: true,
          subtree: true,
          attributes: false,
          characterData: true
        });
      }
    });
    if (this.observer) {
      this.observer.observe(document.body, {
        attributes: true,
        attributeFilter: ["class"]
      });
    }
  }
  setupIconStabilizationObserver() {
    this.iconObserver = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        if (mutation.type === "childList" && mutation.target instanceof Element && mutation.target.classList.contains("workspace-tab-header-inner-icon")) {
          const parentTab = mutation.target.closest(".workspace-tab-header");
          if (parentTab && !parentTab.classList.contains("is-active")) {
            parentTab.classList.add("icon-transition");
            setTimeout(() => {
              if (parentTab) {
                parentTab.classList.remove("icon-transition");
              }
            }, this.plugin.settings.transitionDuration);
          }
        }
      }
    });
    document.querySelectorAll(".workspace-split.mod-vertical.mod-root").forEach((root) => {
      if (this.iconObserver) {
        this.iconObserver.observe(root, {
          childList: true,
          subtree: true
        });
      }
    });
  }
  registerEventHandlers() {
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => {
        this.debounceLayoutChange();
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", this.handleFileOpen.bind(this))
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => {
        this.queueHeaderAdjustment();
      })
    );
    document.body.addEventListener("click", this.handleTabClick.bind(this));
    this.plugin.register(() => document.body.removeEventListener("click", this.handleTabClick.bind(this)));
  }
  debounceLayoutChange() {
    if (this.debounceTimeout) {
      window.clearTimeout(this.debounceTimeout);
    }
    this.debounceTimeout = window.setTimeout(() => {
      this.queueHeaderAdjustment();
      this.debounceTimeout = null;
    }, 100);
  }
  handleTabClick(event) {
    const target = event.target;
    const tabHeader = target == null ? void 0 : target.closest(".workspace-split.mod-vertical.mod-root .workspace-tab-header");
    if (!tabHeader) {
      return;
    }
    if (tabHeader instanceof HTMLElement) {
      setTimeout(() => {
        if (tabHeader.classList.contains("is-active")) {
          this.scrollToActiveTab(tabHeader);
        }
      }, 50);
    }
  }
  handleFileOpen() {
    const activeHeaders = document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header.is-active");
    activeHeaders.forEach((header) => {
      if (header instanceof HTMLElement) {
        this.stabilizeIcon(header);
        setTimeout(() => {
          if (!this.tabWidthCache.has(this.getHeaderKey(header))) {
            this.queueHeaderAdjustment();
          }
          this.scrollToActiveTab(header);
        }, 50);
      }
    });
  }
  stabilizeIcon(header) {
    const iconElement = header.querySelector(".workspace-tab-header-inner-icon");
    if (iconElement) {
      iconElement.classList.add("stable-icon");
      const currentIconHTML = iconElement.innerHTML;
      const iconObserver = new MutationObserver(() => {
        if (iconElement.innerHTML !== currentIconHTML) {
          iconElement.innerHTML = currentIconHTML;
        }
      });
      iconObserver.observe(iconElement, { childList: true, subtree: true });
      setTimeout(() => {
        iconObserver.disconnect();
        iconElement.classList.remove("stable-icon");
      }, this.plugin.settings.transitionDuration + 50);
    }
  }
  preserveAllIcons() {
    const headers = this.getAllHeaders();
    headers.forEach((header) => {
      const iconElement = header.querySelector(".workspace-tab-header-inner-icon");
      if (iconElement instanceof HTMLElement) {
        iconElement.style.pointerEvents = "none";
      }
    });
  }
  scrollToActiveTab(activeTab) {
    if (!activeTab.closest(".workspace-split.mod-vertical.mod-root")) {
      return;
    }
    const container = activeTab.closest(".workspace-tab-header-container-inner");
    if (container instanceof HTMLElement) {
      const tabRect = activeTab.getBoundingClientRect();
      const containerRect = container.getBoundingClientRect();
      const tabLeft = activeTab.offsetLeft;
      const tabRight = tabLeft + tabRect.width;
      const containerLeft = container.scrollLeft;
      const containerRight = containerLeft + containerRect.width;
      if (tabLeft < containerLeft || tabRight > containerRight) {
        const targetScroll = tabLeft + tabRect.width / 2 - containerRect.width / 2;
        this.smoothScrollTo(container, container.scrollLeft, Math.max(0, targetScroll), 300);
      }
    }
  }
  smoothScrollTo(element, start, end, duration) {
    const startTime = performance.now();
    const easeInOutQuad = (t) => {
      return t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2;
    };
    const animateScroll = (currentTime) => {
      const elapsedTime = currentTime - startTime;
      const progress = Math.min(elapsedTime / duration, 1);
      const easedProgress = easeInOutQuad(progress);
      const scrollValue = start + (end - start) * easedProgress;
      element.scrollLeft = scrollValue;
      if (progress < 1) {
        requestAnimationFrame(animateScroll);
      }
    };
    requestAnimationFrame(animateScroll);
  }
  queueHeaderAdjustment() {
    if (!this.isAdjustmentQueued) {
      this.isAdjustmentQueued = true;
      requestAnimationFrame(() => {
        this.adjustAllHeaders();
        this.isAdjustmentQueued = false;
      });
    }
  }
  getAllHeaders() {
    return Array.from(document.querySelectorAll(
      ".workspace-split.mod-vertical.mod-root .workspace-tab-header"
    ));
  }
  getHeaderKey(header) {
    const titleElement = header.querySelector(".workspace-tab-header-inner-title");
    return (titleElement == null ? void 0 : titleElement.textContent) || "";
  }
  measureTextWidth(text, element) {
    if (!this.measureElement)
      return 0;
    const styles = window.getComputedStyle(element);
    this.measureElement.style.font = styles.font;
    this.measureElement.style.letterSpacing = styles.letterSpacing;
    this.measureElement.style.textTransform = styles.textTransform;
    this.measureElement.style.fontWeight = styles.fontWeight;
    this.measureElement.textContent = text;
    return Math.ceil(this.measureElement.offsetWidth) + 5;
  }
  calculateHeaderWidth(header) {
    const titleElement = header.querySelector(".workspace-tab-header-inner-title");
    if (!titleElement)
      return this.plugin.settings.minWidth;
    const textWidth = this.measureTextWidth(
      titleElement.textContent || "",
      titleElement
    );
    const iconSpaceNeeded = this.plugin.settings.iconWidth > 0 ? this.plugin.settings.iconWidth : 0;
    const calculatedWidth = Math.ceil(Math.max(
      this.plugin.settings.leftPadding + iconSpaceNeeded + this.plugin.settings.iconRightMargin + textWidth + this.plugin.settings.closeButtonPadding + this.plugin.settings.closeButtonWidth,
      this.plugin.settings.minWidth
    ));
    if (this.plugin.settings.maxWidth > 0) {
      return Math.min(calculatedWidth, this.plugin.settings.maxWidth);
    }
    return calculatedWidth;
  }
  adjustAllHeaders() {
    if (this.isResetting)
      return;
    const headers = this.getAllHeaders().filter((header) => {
      const container = header.closest(".workspace-tab-header-container");
      const isVisible = container && window.getComputedStyle(container).display !== "none";
      const isNotLoading = !header.classList.contains("icon-loading");
      return isVisible && isNotLoading;
    });
    const newCache = /* @__PURE__ */ new Map();
    let activeHeader = null;
    headers.forEach((header) => {
      const headerKey = this.getHeaderKey(header);
      const iconElement = header.querySelector(".workspace-tab-header-inner-icon");
      if (iconElement instanceof HTMLElement) {
        iconElement.style.pointerEvents = "none";
        iconElement.style.transform = "translateZ(0)";
      }
      let width = this.tabWidthCache.get(headerKey);
      if (width === void 0 || header.classList.contains("is-active")) {
        width = this.calculateHeaderWidth(header);
      }
      header.classList.add("autofit-tab");
      header.style.setProperty("--header-width", `${width}px`);
      newCache.set(headerKey, width);
      if (this.plugin.settings.maxWidth > 0 && width >= this.plugin.settings.maxWidth) {
        header.classList.add("autofit-max-width");
        width = Math.min(width, this.plugin.settings.maxWidth + 20);
        header.style.setProperty("--header-width", `${width}px`);
      } else {
        header.classList.remove("autofit-max-width");
      }
      if (header.classList.contains("is-active")) {
        activeHeader = header;
      }
    });
    this.tabWidthCache = newCache;
    if (activeHeader) {
      this.scrollToActiveTab(activeHeader);
    }
  }
  resetTabs(isMaxWidthChanged) {
    this.isResetting = true;
    const headers = this.getAllHeaders();
    headers.forEach((header) => {
      header.classList.remove("autofit-max-width");
      header.classList.remove("autofit-tab");
      header.classList.add("autofit-cleanup");
      header.style.removeProperty("--header-width");
    });
    this.tabWidthCache.clear();
    setTimeout(() => {
      headers.forEach((header) => {
        header.classList.remove("autofit-cleanup");
      });
      setTimeout(() => {
        headers.forEach((header) => {
          header.classList.add("autofit-tab");
        });
        this.adjustAllHeaders();
        this.isResetting = false;
      }, 50);
    }, 100);
  }
};

// src/main.ts
var AutoFitTabsPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new AutoFitTabsSettingTab(this.app, this));
    this.tabManager = new TabManager(this);
    this.updateCSSVariables();
    this.tabManager.initialize();
  }
  onunload() {
    this.tabManager.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  updateCSSVariables() {
    const cssVars = {
      "--autofit-min-width": `${this.settings.minWidth}px`,
      "--autofit-close-button-width": `${this.settings.closeButtonWidth}px`,
      "--autofit-left-padding": `${this.settings.leftPadding}px`,
      "--autofit-icon-right-margin": `${this.settings.iconRightMargin}px`,
      "--autofit-close-button-padding": `${this.settings.closeButtonPadding}px`,
      "--autofit-transition-duration": `${this.settings.transitionDuration}ms`,
      "--autofit-icon-width": `${this.settings.iconWidth}px`,
      "--autofit-icon-display": this.settings.iconWidth > 0 ? "flex" : "none",
      // Hide icon completely when width is 0
      "--autofit-max-width": this.settings.maxWidth > 0 ? `${this.settings.maxWidth}px` : "none"
    };
    Object.entries(cssVars).forEach(([property, value]) => {
      document.documentElement.style.setProperty(property, value);
    });
  }
  async saveSettings() {
    const previousMaxWidth = this.settings.maxWidth;
    await this.saveData(this.settings);
    this.updateCSSVariables();
    const isMaxWidthChanged = previousMaxWidth > 0 && this.settings.maxWidth === 0;
    if (isMaxWidthChanged) {
      this.tabManager.resetTabs(isMaxWidthChanged);
    } else {
      this.tabManager.queueHeaderAdjustment();
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvdGFiTWFuYWdlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiXG5pbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBQbHVnaW5TZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQXV0b0ZpdFRhYnNTZXR0aW5nVGFiIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBUYWJNYW5hZ2VyIH0gZnJvbSAnLi90YWJNYW5hZ2VyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXV0b0ZpdFRhYnNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncztcbiAgICBwcml2YXRlIHRhYk1hbmFnZXI6IFRhYk1hbmFnZXI7XG5cbiAgICBhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQXV0b0ZpdFRhYnNTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnRhYk1hbmFnZXIgPSBuZXcgVGFiTWFuYWdlcih0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGVDU1NWYXJpYWJsZXMoKTtcbiAgICAgICAgdGhpcy50YWJNYW5hZ2VyLmluaXRpYWxpemUoKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50YWJNYW5hZ2VyLmNsZWFudXAoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGxvYWRTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgdXBkYXRlQ1NTVmFyaWFibGVzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjc3NWYXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgICAgICAgJy0tYXV0b2ZpdC1taW4td2lkdGgnOiBgJHt0aGlzLnNldHRpbmdzLm1pbldpZHRofXB4YCxcbiAgICAgICAgICAgICctLWF1dG9maXQtY2xvc2UtYnV0dG9uLXdpZHRoJzogYCR7dGhpcy5zZXR0aW5ncy5jbG9zZUJ1dHRvbldpZHRofXB4YCxcbiAgICAgICAgICAgICctLWF1dG9maXQtbGVmdC1wYWRkaW5nJzogYCR7dGhpcy5zZXR0aW5ncy5sZWZ0UGFkZGluZ31weGAsXG4gICAgICAgICAgICAnLS1hdXRvZml0LWljb24tcmlnaHQtbWFyZ2luJzogYCR7dGhpcy5zZXR0aW5ncy5pY29uUmlnaHRNYXJnaW59cHhgLFxuICAgICAgICAgICAgJy0tYXV0b2ZpdC1jbG9zZS1idXR0b24tcGFkZGluZyc6IGAke3RoaXMuc2V0dGluZ3MuY2xvc2VCdXR0b25QYWRkaW5nfXB4YCxcbiAgICAgICAgICAgICctLWF1dG9maXQtdHJhbnNpdGlvbi1kdXJhdGlvbic6IGAke3RoaXMuc2V0dGluZ3MudHJhbnNpdGlvbkR1cmF0aW9ufW1zYCxcbiAgICAgICAgICAgICctLWF1dG9maXQtaWNvbi13aWR0aCc6IGAke3RoaXMuc2V0dGluZ3MuaWNvbldpZHRofXB4YCxcbiAgICAgICAgICAgICctLWF1dG9maXQtaWNvbi1kaXNwbGF5JzogdGhpcy5zZXR0aW5ncy5pY29uV2lkdGggPiAwID8gJ2ZsZXgnIDogJ25vbmUnLCAvLyBIaWRlIGljb24gY29tcGxldGVseSB3aGVuIHdpZHRoIGlzIDBcbiAgICAgICAgICAgICctLWF1dG9maXQtbWF4LXdpZHRoJzogdGhpcy5zZXR0aW5ncy5tYXhXaWR0aCA+IDAgPyBgJHt0aGlzLnNldHRpbmdzLm1heFdpZHRofXB4YCA6ICdub25lJ1xuICAgICAgICB9O1xuXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNzc1ZhcnMpLmZvckVhY2goKFtwcm9wZXJ0eSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkocHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwcmV2aW91c01heFdpZHRoID0gdGhpcy5zZXR0aW5ncy5tYXhXaWR0aDtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgdGhpcy51cGRhdGVDU1NWYXJpYWJsZXMoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG1heCB3aWR0aCB3YXMgZGlzYWJsZWQsIGNvbXBsZXRlbHkgcmVzZXQgYWxsIHRhYnNcbiAgICAgICAgY29uc3QgaXNNYXhXaWR0aENoYW5nZWQgPSBwcmV2aW91c01heFdpZHRoID4gMCAmJiB0aGlzLnNldHRpbmdzLm1heFdpZHRoID09PSAwO1xuICAgICAgICBpZiAoaXNNYXhXaWR0aENoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMudGFiTWFuYWdlci5yZXNldFRhYnMoaXNNYXhXaWR0aENoYW5nZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSnVzdCByZWNhbGN1bGF0ZSBub3JtYWxseSBmb3Igb3RoZXIgc2V0dGluZyBjaGFuZ2VzXG4gICAgICAgICAgICB0aGlzLnRhYk1hbmFnZXIucXVldWVIZWFkZXJBZGp1c3RtZW50KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiXG5leHBvcnQgaW50ZXJmYWNlIFBsdWdpblNldHRpbmdzIHtcbiAgICBtaW5XaWR0aDogbnVtYmVyO1xuICAgIGNsb3NlQnV0dG9uV2lkdGg6IG51bWJlcjtcbiAgICBsZWZ0UGFkZGluZzogbnVtYmVyO1xuICAgIGljb25SaWdodE1hcmdpbjogbnVtYmVyO1xuICAgIGNsb3NlQnV0dG9uUGFkZGluZzogbnVtYmVyO1xuICAgIHRyYW5zaXRpb25EdXJhdGlvbjogbnVtYmVyO1xuICAgIGljb25XaWR0aDogbnVtYmVyO1xuICAgIG1heFdpZHRoOiBudW1iZXI7XG4gICAgW2tleTogc3RyaW5nXTogbnVtYmVyOyAvLyBJbmRleCBzaWduYXR1cmUgdG8gYWxsb3cgc3RyaW5nIGluZGV4aW5nXG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICBtaW5XaWR0aDogNDAsXG4gICAgY2xvc2VCdXR0b25XaWR0aDogMjgsXG4gICAgbGVmdFBhZGRpbmc6IDEyLFxuICAgIGljb25SaWdodE1hcmdpbjogMCxcbiAgICBjbG9zZUJ1dHRvblBhZGRpbmc6IDAsXG4gICAgdHJhbnNpdGlvbkR1cmF0aW9uOiAyNzUsXG4gICAgaWNvbldpZHRoOiAyMCxcbiAgICBtYXhXaWR0aDogMCAvLyAwIG1lYW5zIGRpc2FibGVkXG59IGFzIFBsdWdpblNldHRpbmdzO1xuIiwgIlxuaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBQbHVnaW5TZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IEF1dG9GaXRUYWJzUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBBdXRvRml0VGFic1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEF1dG9GaXRUYWJzUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQXV0b0ZpdFRhYnNQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlU2V0dGluZ3NVSShjb250YWluZXJFbCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVTZXR0aW5nc1VJKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gR2VuZXJhbCBzZXR0aW5ncyBhdCB0aGUgdG9wIHdpdGhvdXQgYSBoZWFkaW5nXG4gICAgICAgIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnQ2xvc2UgYnV0dG9uIHBhZGRpbmcnLFxuICAgICAgICAgICAgICAgIGRlc2M6ICdTcGFjZSBpbiBwaXhlbHMgYmVmb3JlIGNsb3NlIGJ1dHRvbicsXG4gICAgICAgICAgICAgICAgcHJvcDogJ2Nsb3NlQnV0dG9uUGFkZGluZycgYXMga2V5b2YgUGx1Z2luU2V0dGluZ3NcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ1RyYW5zaXRpb24gZHVyYXRpb24nLFxuICAgICAgICAgICAgICAgIGRlc2M6ICdEdXJhdGlvbiBpbiBtaWxsaXNlY29uZHMgZm9yIHNtb290aCB0cmFuc2l0aW9ucycsXG4gICAgICAgICAgICAgICAgcHJvcDogJ3RyYW5zaXRpb25EdXJhdGlvbicgYXMga2V5b2YgUGx1Z2luU2V0dGluZ3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgXS5mb3JFYWNoKCh7IG5hbWUsIGRlc2MsIHByb3AgfSkgPT4ge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKG5hbWUpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoYCR7ZGVzY30gKGRlZmF1bHQ6ICR7REVGQVVMVF9TRVRUSU5HU1twcm9wXX0pYClcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFN0cmluZyhERUZBVUxUX1NFVFRJTkdTW3Byb3BdKSlcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5nc1twcm9wXSkpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bVZhbHVlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtVmFsdWUpICYmIG51bVZhbHVlID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5nc1twcm9wXSA9IG51bVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSB0cmFuc2l0aW9uIGR1cmF0aW9uIGlzIGFwcGxpZWQgd2l0aCBhbnkgc2V0dGluZ3MgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQ1NTVmFyaWFibGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVTZXR0aW5nc1NlY3Rpb24oY29udGFpbmVyLCAnQmFzaWMgZGltZW5zaW9ucycsIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnTWluaW11bSB3aWR0aCcsXG4gICAgICAgICAgICAgICAgZGVzYzogJ01pbmltdW0gd2lkdGggaW4gcGl4ZWxzIGZvciB2ZXJ5IHNob3J0IHRpdGxlcycsXG4gICAgICAgICAgICAgICAgcHJvcDogJ21pbldpZHRoJyBhcyBrZXlvZiBQbHVnaW5TZXR0aW5nc1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnTWF4IHdpZHRoJyxcbiAgICAgICAgICAgICAgICBkZXNjOiAnTWF4aW11bSB3aWR0aCBpbiBwaXhlbHMgZm9yIHRhYnMgKDAgdG8gZGlzYWJsZSknLFxuICAgICAgICAgICAgICAgIHByb3A6ICdtYXhXaWR0aCcgYXMga2V5b2YgUGx1Z2luU2V0dGluZ3NcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0Nsb3NlIGJ1dHRvbiB3aWR0aCcsXG4gICAgICAgICAgICAgICAgZGVzYzogJ1dpZHRoIGluIHBpeGVscyBmb3IgdGhlIHRhYiBjbG9zZSBidXR0b24nLFxuICAgICAgICAgICAgICAgIHByb3A6ICdjbG9zZUJ1dHRvbldpZHRoJyBhcyBrZXlvZiBQbHVnaW5TZXR0aW5nc1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnTGVmdCBwYWRkaW5nJyxcbiAgICAgICAgICAgICAgICBkZXNjOiAnUGFkZGluZyBpbiBwaXhlbHMgYmVmb3JlIHRoZSBpY29uJyxcbiAgICAgICAgICAgICAgICBwcm9wOiAnbGVmdFBhZGRpbmcnIGFzIGtleW9mIFBsdWdpblNldHRpbmdzXG4gICAgICAgICAgICB9XG4gICAgICAgIF0pO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlU2V0dGluZ3NTZWN0aW9uKGNvbnRhaW5lciwgJ0ljb25zJywgW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdJY29uIHdpZHRoJyxcbiAgICAgICAgICAgICAgICBkZXNjOiAnV2lkdGggaW4gcGl4ZWxzIGZvciB0YWIgaWNvbnMnLFxuICAgICAgICAgICAgICAgIHByb3A6ICdpY29uV2lkdGgnIGFzIGtleW9mIFBsdWdpblNldHRpbmdzXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdJY29uIHJpZ2h0IG1hcmdpbicsXG4gICAgICAgICAgICAgICAgZGVzYzogJ1NwYWNlIGluIHBpeGVscyBiZXR3ZWVuIGljb24gYW5kIHRleHQnLFxuICAgICAgICAgICAgICAgIHByb3A6ICdpY29uUmlnaHRNYXJnaW4nIGFzIGtleW9mIFBsdWdpblNldHRpbmdzXG4gICAgICAgICAgICB9XG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU2V0dGluZ3NTZWN0aW9uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHRpdGxlOiBzdHJpbmcsIHNldHRpbmdzOiBBcnJheTx7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgICAgZGVzYzogc3RyaW5nO1xuICAgICAgICBwcm9wOiBrZXlvZiBQbHVnaW5TZXR0aW5ncztcbiAgICB9Pik6IHZvaWQge1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZSh0aXRsZSlcbiAgICAgICAgICAgIC5zZXRIZWFkaW5nKCk7XG4gICAgICAgIFxuICAgICAgICBzZXR0aW5ncy5mb3JFYWNoKCh7IG5hbWUsIGRlc2MsIHByb3AgfSkgPT4ge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKG5hbWUpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoYCR7ZGVzY30gKGRlZmF1bHQ6ICR7REVGQVVMVF9TRVRUSU5HU1twcm9wXX0pYClcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFN0cmluZyhERUZBVUxUX1NFVFRJTkdTW3Byb3BdKSlcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5nc1twcm9wXSkpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bVZhbHVlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtVmFsdWUpICYmIG51bVZhbHVlID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5nc1twcm9wXSA9IG51bVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsICJcbmltcG9ydCB7IFRBYnN0cmFjdEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQXV0b0ZpdFRhYnNQbHVnaW4gZnJvbSAnLi9tYWluJztcblxuZXhwb3J0IGNsYXNzIFRhYk1hbmFnZXIge1xuICAgIHByaXZhdGUgcGx1Z2luOiBBdXRvRml0VGFic1BsdWdpbjtcbiAgICBwcml2YXRlIHRhYldpZHRoQ2FjaGU6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBvYnNlcnZlcjogTXV0YXRpb25PYnNlcnZlciB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgaWNvbk9ic2VydmVyOiBNdXRhdGlvbk9ic2VydmVyIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBtZWFzdXJlRWxlbWVudDogSFRNTFNwYW5FbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBkZWJvdW5jZVRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgaXNBZGp1c3RtZW50UXVldWVkID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpc1Jlc2V0dGluZyA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBBdXRvRml0VGFic1BsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNldHVwTWVhc3VyZUVsZW1lbnQoKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50SGFuZGxlcnMoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEluaXRpYWwgYWRqdXN0bWVudCB0byBnZXQgdGFicyBzaXplZCBjb3JyZWN0bHlcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnF1ZXVlSGVhZGVyQWRqdXN0bWVudCgpO1xuICAgICAgICAgICAgdGhpcy5zZXR1cE11dGF0aW9uT2JzZXJ2ZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dXBJY29uU3RhYmlsaXphdGlvbk9ic2VydmVyKCk7XG4gICAgICAgIH0sIDMwMCk7XG4gICAgfVxuXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50YWJXaWR0aENhY2hlLmNsZWFyKCk7XG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyKSB0aGlzLm9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgaWYgKHRoaXMuaWNvbk9ic2VydmVyKSB0aGlzLmljb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIGlmICh0aGlzLm1lYXN1cmVFbGVtZW50KSB0aGlzLm1lYXN1cmVFbGVtZW50LnJlbW92ZSgpO1xuXG4gICAgICAgIC8vIFJlc2V0IHRoZSB0YWIgY29udGFpbmVycyB0byBkZWZhdWx0IHN0eWxlIChvbmx5IG1haW4gZWRpdG9yIGFyZWEpXG4gICAgICAgIGNvbnN0IHRhYkNvbnRhaW5lcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCAud29ya3NwYWNlLXRhYi1oZWFkZXItY29udGFpbmVyLWlubmVyJyk7XG4gICAgICAgIHRhYkNvbnRhaW5lcnMuZm9yRWFjaChjb250YWluZXIgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLm92ZXJmbG93WCA9ICcnO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5vdmVyZmxvd1kgPSAnJztcbiAgICAgICAgICAgICAgICBjb250YWluZXIuc2Nyb2xsTGVmdCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0aGlzLmdldEFsbEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7XG4gICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LmFkZCgnYXV0b2ZpdC1jbGVhbnVwJyk7XG4gICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnYXV0b2ZpdC10YWInKTtcbiAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdhdXRvZml0LW1heC13aWR0aCcpO1xuICAgICAgICAgICAgaGVhZGVyLnN0eWxlLnJlbW92ZVByb3BlcnR5KCctLWhlYWRlci13aWR0aCcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnYXV0b2ZpdC1jbGVhbnVwJyk7XG4gICAgICAgICAgICB9LCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50cmFuc2l0aW9uRHVyYXRpb24pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwTWVhc3VyZUVsZW1lbnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWVhc3VyZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHRoaXMubWVhc3VyZUVsZW1lbnQuY2xhc3NOYW1lID0gJ2F1dG9maXQtdGFiLW1lYXN1cmUnO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMubWVhc3VyZUVsZW1lbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0dXBNdXRhdGlvbk9ic2VydmVyKCk6IHZvaWQge1xuICAgICAgICAvLyBFeHBsaWNpdGx5IGZpbHRlciBmb3Igb25seSB0aGUgbWFpbiBjb250ZW50IGFyZWEgdGFic1xuICAgICAgICBjb25zdCB0YWJDb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndvcmtzcGFjZS1zcGxpdC5tb2QtdmVydGljYWwubW9kLXJvb3QgLndvcmtzcGFjZS10YWItaGVhZGVyLWNvbnRhaW5lcicpO1xuICAgICAgICAvLyBTa2lwIGFueSBvYnNlcnZhdGlvbiBpZiB3ZSBkaWRuJ3QgZmluZCBhbnkgbWF0Y2hpbmcgY29udGFpbmVyc1xuICAgICAgICBpZiAoIXRhYkNvbnRhaW5lcnMgfHwgdGFiQ29udGFpbmVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vIE5vIHdvcmtzcGFjZSB0YWJzIGZvdW5kIGluIG1haW4gY29udGVudCBhcmVhXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XG4gICAgICAgICAgICAvLyBPbmx5IHRyaWdnZXIgb24gcmVsZXZhbnQgdGFiIGNoYW5nZXMsIG5vdCBldmVyeSBET00gY2hhbmdlXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgY2FyZSBhYm91dCBzcGVjaWZpYyB0YWItcmVsYXRlZCBjaGFuZ2VzXG4gICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uLnRhcmdldCAmJiBtdXRhdGlvbi50YXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE9OTFkgdGFyZ2V0IHRhYnMgaW4gdGhlIG1haW4gZWRpdG9yIGFyZWFcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtdXRhdGlvbi50YXJnZXQuY2xvc2VzdCgnLndvcmtzcGFjZS1zcGxpdC5tb2QtdmVydGljYWwubW9kLXJvb3QnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIFNraXAgdGhpcyBtdXRhdGlvblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgY2hlY2sgZm9yIG1haW4gZWRpdG9yIGFyZWEgdGFicyAobm90IHNpZGVkb2NrL2xlZnQgcGFuZSlcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNUYWJFbGVtZW50ID0gKFxuICAgICAgICAgICAgICAgICAgICAgICAgKG11dGF0aW9uLnRhcmdldC5jbG9zZXN0KCcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCAud29ya3NwYWNlLXRhYi1oZWFkZXInKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChtdXRhdGlvbi50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd3b3Jrc3BhY2UtdGFiLWhlYWRlci1pbm5lci10aXRsZScpICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uLnRhcmdldC5jbG9zZXN0KCcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCcpKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVGFiRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWV1ZUhlYWRlckFkanVzdG1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHRoZW1lIGNoYW5nZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uLnRhcmdldCA9PT0gZG9jdW1lbnQuYm9keSAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uLnR5cGUgPT09ICdhdHRyaWJ1dGVzJyAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFiV2lkdGhDYWNoZS5jbGVhcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWV1ZUhlYWRlckFkanVzdG1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBPbmx5IG9ic2VydmUgbWFpbiBlZGl0b3IgdGFiIGNvbnRhaW5lcnMgZm9yIGNoYW5nZXNcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndvcmtzcGFjZS1zcGxpdC5tb2QtdmVydGljYWwubW9kLXJvb3QgLndvcmtzcGFjZS10YWItaGVhZGVyLWNvbnRhaW5lcicpLmZvckVhY2goY29udGFpbmVyID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9ic2VydmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vYnNlcnZlci5vYnNlcnZlKGNvbnRhaW5lciwge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gT2JzZXJ2ZSB0aGVtZSBjaGFuZ2VzXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbJ2NsYXNzJ11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cEljb25TdGFiaWxpemF0aW9uT2JzZXJ2ZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaWNvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcgJiZcbiAgICAgICAgICAgICAgICAgICAgbXV0YXRpb24udGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCAmJlxuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd3b3Jrc3BhY2UtdGFiLWhlYWRlci1pbm5lci1pY29uJykpIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgbXVsdGlwbGUgaWNvbiBjaGFuZ2VzIHdpdGhpbiB0aGUgdHJhbnNpdGlvbiBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRUYWIgPSBtdXRhdGlvbi50YXJnZXQuY2xvc2VzdCgnLndvcmtzcGFjZS10YWItaGVhZGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRUYWIgJiYgIXBhcmVudFRhYi5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWFjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRUYWIuY2xhc3NMaXN0LmFkZCgnaWNvbi10cmFuc2l0aW9uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50VGFiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFRhYi5jbGFzc0xpc3QucmVtb3ZlKCdpY29uLXRyYW5zaXRpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50cmFuc2l0aW9uRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBPYnNlcnZlIGFsbCB0YWJzIGZvciBpY29uIGNoYW5nZXNcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndvcmtzcGFjZS1zcGxpdC5tb2QtdmVydGljYWwubW9kLXJvb3QnKS5mb3JFYWNoKHJvb3QgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaWNvbk9ic2VydmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pY29uT2JzZXJ2ZXIub2JzZXJ2ZShyb290LCB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZWdpc3RlckV2ZW50SGFuZGxlcnMoKTogdm9pZCB7XG4gICAgICAgIC8vIEhhbmRsZSBsYXlvdXQgY2hhbmdlcyAobGlrZSBzcGxpdCByZXNpemluZylcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2xheW91dC1jaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRGVib3VuY2UgdG8gYXZvaWQgZXhjZXNzaXZlIHJlY2FsY3VsYXRpb25zIGR1cmluZyByZXNpemVcbiAgICAgICAgICAgICAgICB0aGlzLmRlYm91bmNlTGF5b3V0Q2hhbmdlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEhhbmRsZSBmaWxlIG9wZW5zIC0gaW1wb3J0YW50IGZvciBjaGFuZ2luZyB0YWIgY29udGVudFxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZmlsZS1vcGVuJywgdGhpcy5oYW5kbGVGaWxlT3Blbi5iaW5kKHRoaXMpKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVnaXN0ZXIgZm9yIHJlbmFtZSBldmVudHNcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbigncmVuYW1lJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucXVldWVIZWFkZXJBZGp1c3RtZW50KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGNsaWNrIGV2ZW50IGxpc3RlbmVyIGZvciB0YWIgc2VsZWN0aW9uXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZVRhYkNsaWNrLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlcigoKSA9PiBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVUYWJDbGljay5iaW5kKHRoaXMpKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkZWJvdW5jZUxheW91dENoYW5nZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGVib3VuY2VUaW1lb3V0KSB7XG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2VUaW1lb3V0KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5kZWJvdW5jZVRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnF1ZXVlSGVhZGVyQWRqdXN0bWVudCgpO1xuICAgICAgICAgICAgdGhpcy5kZWJvdW5jZVRpbWVvdXQgPSBudWxsO1xuICAgICAgICB9LCAxMDApO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlVGFiQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICBjb25zdCB0YWJIZWFkZXIgPSB0YXJnZXQ/LmNsb3Nlc3QoJy53b3Jrc3BhY2Utc3BsaXQubW9kLXZlcnRpY2FsLm1vZC1yb290IC53b3Jrc3BhY2UtdGFiLWhlYWRlcicpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0YWJIZWFkZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFiSGVhZGVyIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgIC8vIFdhaXQgYSBtb21lbnQgZm9yIHRoZSBhY3RpdmUgY2xhc3MgdG8gYmUgYXBwbGllZFxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRhYkhlYWRlci5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWFjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9BY3RpdmVUYWIodGFiSGVhZGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZUZpbGVPcGVuKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBhY3RpdmVIZWFkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndvcmtzcGFjZS1zcGxpdC5tb2QtdmVydGljYWwubW9kLXJvb3QgLndvcmtzcGFjZS10YWItaGVhZGVyLmlzLWFjdGl2ZScpO1xuICAgICAgICBhY3RpdmVIZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgIGlmIChoZWFkZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBpY29uIGZsaWNrZXJpbmcgaXNzdWUgc3BlY2lmaWNhbGx5XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFiaWxpemVJY29uKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy50YWJXaWR0aENhY2hlLmhhcyh0aGlzLmdldEhlYWRlcktleShoZWFkZXIpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWV1ZUhlYWRlckFkanVzdG1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvQWN0aXZlVGFiKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgfSwgNTApOyAvLyBTaG9ydGVyIGRlbGF5IGFmdGVyIHN0YWJpbGl6aW5nIGljb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGFiaWxpemVJY29uKGhlYWRlcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaWNvbkVsZW1lbnQgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS10YWItaGVhZGVyLWlubmVyLWljb24nKTtcbiAgICAgICAgaWYgKGljb25FbGVtZW50KSB7XG4gICAgICAgICAgICAvLyBBZGQgYSBjbGFzcyB0byBwcmV2ZW50IGljb24gdHJhbnNpdGlvbnNcbiAgICAgICAgICAgIGljb25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3N0YWJsZS1pY29uJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBjdXJyZW50IEhUTUwgY29udGVudCB0byBwcmV2ZW50IGZsaWNrZXJpbmdcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJY29uSFRNTCA9IGljb25FbGVtZW50LmlubmVySFRNTDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgTXV0YXRpb25PYnNlcnZlciB0byBwcmV2ZW50IHVud2FudGVkIGljb24gY2hhbmdlc1xuICAgICAgICAgICAgY29uc3QgaWNvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIElmIGljb24gaXMgYWJvdXQgdG8gY2hhbmdlIGR1cmluZyB0cmFuc2l0aW9uLCBmb3JjZSBpdCB0byBzdGF5XG4gICAgICAgICAgICAgICAgaWYgKGljb25FbGVtZW50LmlubmVySFRNTCAhPT0gY3VycmVudEljb25IVE1MKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEtlZXAgdGhlIG9yaWdpbmFsIGljb24gdW50aWwgdHJhbnNpdGlvbiBjb21wbGV0ZXNcbiAgICAgICAgICAgICAgICAgICAgaWNvbkVsZW1lbnQuaW5uZXJIVE1MID0gY3VycmVudEljb25IVE1MO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBPYnNlcnZlIG9ubHkgY2hhbmdlcyB0byB0aGUgaWNvbidzIGNvbnRlbnRcbiAgICAgICAgICAgIGljb25PYnNlcnZlci5vYnNlcnZlKGljb25FbGVtZW50LCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGlzY29ubmVjdCBhZnRlciB0aGUgdHJhbnNpdGlvbiBjb21wbGV0ZXNcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGljb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgaWNvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc3RhYmxlLWljb24nKTtcbiAgICAgICAgICAgIH0sIHRoaXMucGx1Z2luLnNldHRpbmdzLnRyYW5zaXRpb25EdXJhdGlvbiArIDUwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcHJlc2VydmVBbGxJY29ucygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHRoaXMuZ2V0QWxsSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGljb25FbGVtZW50ID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2UtdGFiLWhlYWRlci1pbm5lci1pY29uJyk7XG4gICAgICAgICAgICBpZiAoaWNvbkVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgYW55IGljb24gY2hhbmdlcyBkdXJpbmcgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIGljb25FbGVtZW50LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2Nyb2xsVG9BY3RpdmVUYWIoYWN0aXZlVGFiOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICAvLyBPbmx5IHByb2Nlc3MgdGFicyBpbiB0aGUgbWFpbiBlZGl0b3IgYXJlYVxuICAgICAgICBpZiAoIWFjdGl2ZVRhYi5jbG9zZXN0KCcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCcpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGFjdGl2ZVRhYi5jbG9zZXN0KCcud29ya3NwYWNlLXRhYi1oZWFkZXItY29udGFpbmVyLWlubmVyJyk7XG4gICAgICAgIGlmIChjb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBjZW50ZXIgcG9zaXRpb24gb2YgdGhlIGFjdGl2ZSB0YWJcbiAgICAgICAgICAgIGNvbnN0IHRhYlJlY3QgPSBhY3RpdmVUYWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFiIGlzIGFscmVhZHkgdmlzaWJsZSBpbiB0aGUgdmlld3BvcnRcbiAgICAgICAgICAgIGNvbnN0IHRhYkxlZnQgPSBhY3RpdmVUYWIub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgIGNvbnN0IHRhYlJpZ2h0ID0gdGFiTGVmdCArIHRhYlJlY3Qud2lkdGg7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXJMZWZ0ID0gY29udGFpbmVyLnNjcm9sbExlZnQ7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXJSaWdodCA9IGNvbnRhaW5lckxlZnQgKyBjb250YWluZXJSZWN0LndpZHRoO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBPbmx5IHNjcm9sbCBpZiB0aGUgdGFiIGlzIG5vdCBmdWxseSB2aXNpYmxlXG4gICAgICAgICAgICBpZiAodGFiTGVmdCA8IGNvbnRhaW5lckxlZnQgfHwgdGFiUmlnaHQgPiBjb250YWluZXJSaWdodCkge1xuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBzbW9vdGggc2Nyb2xsIHBvc2l0aW9uIC0gY2VudGVyaW5nIHRoZSB0YWJcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRTY3JvbGwgPSAodGFiTGVmdCArICh0YWJSZWN0LndpZHRoIC8gMikpIC0gKGNvbnRhaW5lclJlY3Qud2lkdGggLyAyKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVc2Ugc21vb3RoIHNjcm9sbGluZyB3aXRoIGEgY3VzdG9tIGFuaW1hdGlvblxuICAgICAgICAgICAgICAgIHRoaXMuc21vb3RoU2Nyb2xsVG8oY29udGFpbmVyLCBjb250YWluZXIuc2Nyb2xsTGVmdCwgTWF0aC5tYXgoMCwgdGFyZ2V0U2Nyb2xsKSwgMzAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc21vb3RoU2Nyb2xsVG8oZWxlbWVudDogSFRNTEVsZW1lbnQsIHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyLCBkdXJhdGlvbjogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICBcbiAgICAgICAgLy8gRWFzaW5nIGZ1bmN0aW9uIC0gZWFzZUluT3V0UXVhZCBmb3Igc21vb3RoZXIgbW90aW9uXG4gICAgICAgIGNvbnN0IGVhc2VJbk91dFF1YWQgPSAodDogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0IDwgMC41ID8gMiAqIHQgKiB0IDogMSAtIE1hdGgucG93KC0yICogdCArIDIsIDIpIC8gMjtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGFuaW1hdGVTY3JvbGwgPSAoY3VycmVudFRpbWU6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxhcHNlZFRpbWUgPSBjdXJyZW50VGltZSAtIHN0YXJ0VGltZTtcbiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5taW4oZWxhcHNlZFRpbWUgLyBkdXJhdGlvbiwgMSk7XG4gICAgICAgICAgICBjb25zdCBlYXNlZFByb2dyZXNzID0gZWFzZUluT3V0UXVhZChwcm9ncmVzcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHNjcm9sbFZhbHVlID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpICogZWFzZWRQcm9ncmVzcztcbiAgICAgICAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbFZhbHVlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocHJvZ3Jlc3MgPCAxKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGVTY3JvbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGVTY3JvbGwpO1xuICAgIH1cblxuICAgIHF1ZXVlSGVhZGVyQWRqdXN0bWVudCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzQWRqdXN0bWVudFF1ZXVlZCkge1xuICAgICAgICAgICAgdGhpcy5pc0FkanVzdG1lbnRRdWV1ZWQgPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRqdXN0QWxsSGVhZGVycygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNBZGp1c3RtZW50UXVldWVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEFsbEhlYWRlcnMoKTogSFRNTEVsZW1lbnRbXSB7XG4gICAgICAgIC8vIE9ubHkgZ2V0IGhlYWRlcnMgaW4gdGhlIG1haW4gZWRpdG9yIGFyZWFcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgICAgICcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCAud29ya3NwYWNlLXRhYi1oZWFkZXInXG4gICAgICAgICkpIGFzIEhUTUxFbGVtZW50W107XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRIZWFkZXJLZXkoaGVhZGVyOiBIVE1MRWxlbWVudCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYi1oZWFkZXItaW5uZXItdGl0bGUnKTtcbiAgICAgICAgcmV0dXJuIHRpdGxlRWxlbWVudD8udGV4dENvbnRlbnQgfHwgJyc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBtZWFzdXJlVGV4dFdpZHRoKHRleHQ6IHN0cmluZywgZWxlbWVudDogRWxlbWVudCk6IG51bWJlciB7XG4gICAgICAgIGlmICghdGhpcy5tZWFzdXJlRWxlbWVudCkgcmV0dXJuIDA7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbiAgICAgICAgdGhpcy5tZWFzdXJlRWxlbWVudC5zdHlsZS5mb250ID0gc3R5bGVzLmZvbnQ7XG4gICAgICAgIHRoaXMubWVhc3VyZUVsZW1lbnQuc3R5bGUubGV0dGVyU3BhY2luZyA9IHN0eWxlcy5sZXR0ZXJTcGFjaW5nO1xuICAgICAgICB0aGlzLm1lYXN1cmVFbGVtZW50LnN0eWxlLnRleHRUcmFuc2Zvcm0gPSBzdHlsZXMudGV4dFRyYW5zZm9ybTtcbiAgICAgICAgdGhpcy5tZWFzdXJlRWxlbWVudC5zdHlsZS5mb250V2VpZ2h0ID0gc3R5bGVzLmZvbnRXZWlnaHQ7XG4gICAgICAgIHRoaXMubWVhc3VyZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGEgc21hbGwgcGFkZGluZyBidWZmZXIgdG8gZW5zdXJlIHRleHQgZml0c1xuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHRoaXMubWVhc3VyZUVsZW1lbnQub2Zmc2V0V2lkdGgpICsgNTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNhbGN1bGF0ZUhlYWRlcldpZHRoKGhlYWRlcjogSFRNTEVsZW1lbnQpOiBudW1iZXIge1xuICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS10YWItaGVhZGVyLWlubmVyLXRpdGxlJyk7XG4gICAgICAgIGlmICghdGl0bGVFbGVtZW50KSByZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3MubWluV2lkdGg7XG5cbiAgICAgICAgY29uc3QgdGV4dFdpZHRoID0gdGhpcy5tZWFzdXJlVGV4dFdpZHRoKFxuICAgICAgICAgICAgdGl0bGVFbGVtZW50LnRleHRDb250ZW50IHx8ICcnLCBcbiAgICAgICAgICAgIHRpdGxlRWxlbWVudFxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHdpZHRoIHdpdGhvdXQgbWF4V2lkdGggY29uc3RyYWludFxuICAgICAgICAvLyBXaGVuIGljb25XaWR0aCBpcyAwLCB3ZSBzdGlsbCBuZWVkIHRvIHJlc2VydmUgc3BhY2UgZm9yIHRoZSBjbG9zZSBidXR0b25cbiAgICAgICAgLy8gdG8gcHJldmVudCBsYXlvdXQgaml0dGVyIHdoZW4gaG92ZXJpbmdcbiAgICAgICAgY29uc3QgaWNvblNwYWNlTmVlZGVkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaWNvbldpZHRoID4gMCA/IFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaWNvbldpZHRoIDogXG4gICAgICAgICAgICAwO1xuICAgICAgICAgICAgXG4gICAgICAgIGNvbnN0IGNhbGN1bGF0ZWRXaWR0aCA9IE1hdGguY2VpbChNYXRoLm1heChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxlZnRQYWRkaW5nICtcbiAgICAgICAgICAgIGljb25TcGFjZU5lZWRlZCArXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pY29uUmlnaHRNYXJnaW4gK1xuICAgICAgICAgICAgdGV4dFdpZHRoICtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsb3NlQnV0dG9uUGFkZGluZyArXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbG9zZUJ1dHRvbldpZHRoLFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWluV2lkdGhcbiAgICAgICAgKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBcHBseSBtYXhXaWR0aCBpZiBpdCdzIGVuYWJsZWQgKG5vbi16ZXJvKVxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4V2lkdGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oY2FsY3VsYXRlZFdpZHRoLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhXaWR0aCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjYWxjdWxhdGVkV2lkdGg7XG4gICAgfVxuXG4gICAgYWRqdXN0QWxsSGVhZGVycygpOiB2b2lkIHtcbiAgICAgICAgLy8gU2tpcCBhZGp1c3RtZW50IGlmIGN1cnJlbnRseSByZXNldHRpbmdcbiAgICAgICAgaWYgKHRoaXMuaXNSZXNldHRpbmcpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIC8vIE9ubHkgYWRqdXN0IGhlYWRlcnMgdGhhdCBhcmVuJ3QgY3VycmVudGx5IGxvYWRpbmcgaWNvbnNcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHRoaXMuZ2V0QWxsSGVhZGVycygpLmZpbHRlcihoZWFkZXIgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gaGVhZGVyLmNsb3Nlc3QoJy53b3Jrc3BhY2UtdGFiLWhlYWRlci1jb250YWluZXInKTtcbiAgICAgICAgICAgIGNvbnN0IGlzVmlzaWJsZSA9IGNvbnRhaW5lciAmJiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShjb250YWluZXIpLmRpc3BsYXkgIT09ICdub25lJztcbiAgICAgICAgICAgIGNvbnN0IGlzTm90TG9hZGluZyA9ICFoZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdpY29uLWxvYWRpbmcnKTtcbiAgICAgICAgICAgIHJldHVybiBpc1Zpc2libGUgJiYgaXNOb3RMb2FkaW5nO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5ld0NhY2hlID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgICAgICAgbGV0IGFjdGl2ZUhlYWRlcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICAgICAgICBoZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcktleSA9IHRoaXMuZ2V0SGVhZGVyS2V5KGhlYWRlcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvY2sgdGhlIGljb24gc3RhdGUgZHVyaW5nIHRyYW5zaXRpb25zXG4gICAgICAgICAgICBjb25zdCBpY29uRWxlbWVudCA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYi1oZWFkZXItaW5uZXItaWNvbicpO1xuICAgICAgICAgICAgaWYgKGljb25FbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpY29uRWxlbWVudC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIC8vIEZvcmNlIGhhcmR3YXJlIGFjY2VsZXJhdGlvblxuICAgICAgICAgICAgICAgIGljb25FbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVaKDApJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gT25seSByZWNhbGN1bGF0ZSB3aWR0aCBpZiBub3QgaW4gY2FjaGUgb3IgdGFiIGlzIGFjdGl2ZVxuICAgICAgICAgICAgbGV0IHdpZHRoID0gdGhpcy50YWJXaWR0aENhY2hlLmdldChoZWFkZXJLZXkpO1xuICAgICAgICAgICAgaWYgKHdpZHRoID09PSB1bmRlZmluZWQgfHwgaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnaXMtYWN0aXZlJykpIHtcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHRoaXMuY2FsY3VsYXRlSGVhZGVyV2lkdGgoaGVhZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2F1dG9maXQtdGFiJyk7XG4gICAgICAgICAgICBoZWFkZXIuc3R5bGUuc2V0UHJvcGVydHkoJy0taGVhZGVyLXdpZHRoJywgYCR7d2lkdGh9cHhgKTtcbiAgICAgICAgICAgIG5ld0NhY2hlLnNldChoZWFkZXJLZXksIHdpZHRoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQXBwbHkgbWF4V2lkdGggY2xhc3MgaWYgdGhlIHNldHRpbmcgaXMgZW5hYmxlZFxuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heFdpZHRoID4gMCAmJiB3aWR0aCA+PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhXaWR0aCkge1xuICAgICAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdhdXRvZml0LW1heC13aWR0aCcpO1xuICAgICAgICAgICAgICAgIC8vIEFwcGx5IGEgc2xpZ2h0bHkgbGFyZ2VyIG1heC13aWR0aCB0byBhbGxvdyBmb3IgbW9yZSB0ZXh0IHZpc2liaWxpdHlcbiAgICAgICAgICAgICAgICB3aWR0aCA9IE1hdGgubWluKHdpZHRoLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhXaWR0aCArIDIwKTtcbiAgICAgICAgICAgICAgICBoZWFkZXIuc3R5bGUuc2V0UHJvcGVydHkoJy0taGVhZGVyLXdpZHRoJywgYCR7d2lkdGh9cHhgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2F1dG9maXQtbWF4LXdpZHRoJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChoZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1hY3RpdmUnKSkge1xuICAgICAgICAgICAgICAgIGFjdGl2ZUhlYWRlciA9IGhlYWRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy50YWJXaWR0aENhY2hlID0gbmV3Q2FjaGU7XG4gICAgICAgIFxuICAgICAgICAvLyBPbmx5IHNjcm9sbCB0byBhY3RpdmUgdGFiIHdoZW4gbmVlZGVkXG4gICAgICAgIGlmIChhY3RpdmVIZWFkZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9BY3RpdmVUYWIoYWN0aXZlSGVhZGVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlc2V0VGFicyhpc01heFdpZHRoQ2hhbmdlZDogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICAvLyBTZXQgcmVzZXR0aW5nIGZsYWcgdG8gcHJldmVudCBjb25jdXJyZW50IGFkanVzdG1lbnRzXG4gICAgICAgIHRoaXMuaXNSZXNldHRpbmcgPSB0cnVlO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29tcGxldGVseSByZXNldCBhbGwgYWZmZWN0ZWQgdGFic1xuICAgICAgICBjb25zdCBoZWFkZXJzID0gdGhpcy5nZXRBbGxIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuZm9yRWFjaChoZWFkZXIgPT4ge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBjdXN0b20gY2xhc3NlcyBhbmQgc3R5bGluZ1xuICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2F1dG9maXQtbWF4LXdpZHRoJyk7XG4gICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnYXV0b2ZpdC10YWInKTtcbiAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdhdXRvZml0LWNsZWFudXAnKTtcbiAgICAgICAgICAgIGhlYWRlci5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnLS1oZWFkZXItd2lkdGgnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhciBjYWNoZSBhbmQgd2FpdCBmb3IgY2xlYW51cFxuICAgICAgICB0aGlzLnRhYldpZHRoQ2FjaGUuY2xlYXIoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFsbG93IHRpbWUgZm9yIE9ic2lkaWFuJ3MgaW50ZXJuYWwgbGF5b3V0IHRvIHJlc2V0XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgaGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7XG4gICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2F1dG9maXQtY2xlYW51cCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE5vdyByZS1hcHBseSBvdXIgc3R5bGluZyBhZnRlciBhIHNtYWxsIGRlbGF5XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2F1dG9maXQtdGFiJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RBbGxIZWFkZXJzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1Jlc2V0dGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICB9LCAxMDApO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7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LEtBQUssYUFBYTtBQUN4QixTQUFLLGNBQWMsSUFBSSxzQkFBc0IsS0FBSyxLQUFLLElBQUksQ0FBQztBQUU1RCxTQUFLLGFBQWEsSUFBSSxXQUFXLElBQUk7QUFDckMsU0FBSyxtQkFBbUI7QUFDeEIsU0FBSyxXQUFXLFdBQVc7QUFBQSxFQUMvQjtBQUFBLEVBRUEsV0FBaUI7QUFDYixTQUFLLFdBQVcsUUFBUTtBQUFBLEVBQzVCO0FBQUEsRUFFQSxNQUFjLGVBQThCO0FBQ3hDLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDN0U7QUFBQSxFQUVBLHFCQUEyQjtBQUN2QixVQUFNLFVBQWtDO0FBQUEsTUFDcEMsdUJBQXVCLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDeEMsZ0NBQWdDLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDakQsMEJBQTBCLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDM0MsK0JBQStCLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDaEQsa0NBQWtDLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDbkQsaUNBQWlDLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDbEQsd0JBQXdCLEdBQUcsS0FBSyxTQUFTO0FBQUEsTUFDekMsMEJBQTBCLEtBQUssU0FBUyxZQUFZLElBQUksU0FBUztBQUFBO0FBQUEsTUFDakUsdUJBQXVCLEtBQUssU0FBUyxXQUFXLElBQUksR0FBRyxLQUFLLFNBQVMsZUFBZTtBQUFBLElBQ3hGO0FBRUEsV0FBTyxRQUFRLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQyxVQUFVLEtBQUssTUFBTTtBQUNuRCxlQUFTLGdCQUFnQixNQUFNLFlBQVksVUFBVSxLQUFLO0FBQUEsSUFDOUQsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLE1BQU0sZUFBOEI7QUFDaEMsVUFBTSxtQkFBbUIsS0FBSyxTQUFTO0FBQ3ZDLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUNqQyxTQUFLLG1CQUFtQjtBQUd4QixVQUFNLG9CQUFvQixtQkFBbUIsS0FBSyxLQUFLLFNBQVMsYUFBYTtBQUM3RSxRQUFJLG1CQUFtQjtBQUNuQixXQUFLLFdBQVcsVUFBVSxpQkFBaUI7QUFBQSxJQUMvQyxPQUFPO0FBRUgsV0FBSyxXQUFXLHNCQUFzQjtBQUFBLElBQzFDO0FBQUEsRUFDSjtBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
